<div id="onboarding-checklist">
  <div id="onboarding-spinner">
    <div class="spinner"></div>
    <div>Fetching your details…</div>
  </div>
</div>

<script>
(async function(){
  const urlParams = new URLSearchParams(window.location.search);
  const contactId = urlParams.get("contactId");
  const container = document.getElementById("onboarding-checklist");

  if (!contactId) {
    container.innerHTML = "<p style='color:red;'>No contactId in URL.</p>";
    return;
  }
  container.innerHTML = `
    <div class="spinner"></div>
    <div>Fetching your details…</div>
  `;

  try {
    const resp = await fetch(`https://ghl-proxy.fly.dev/contact/${contactId}`);
    if (!resp.ok) throw new Error("Failed to fetch");
    const data = await resp.json();
    const contact = data.contact || {};
    container.innerHTML = `<h2>Hello, ${contact.firstName || "User"}!</h2>`;
  } catch (e) {
    container.innerHTML = `<p style="color:red;">Error loading: ${e.message}</p>`;
  }
})();
</script>
